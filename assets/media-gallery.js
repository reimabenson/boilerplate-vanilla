"use strict";if(!customElements.get("media-gallery"))customElements.define("media-gallery",class MediaGallery extends HTMLElement{constructor(){super();this.elements={liveRegion:this.querySelector('[id^="GalleryStatus"]'),viewer:this.querySelector('[id^="GalleryViewer"]'),thumbnails:this.querySelector('[id^="GalleryThumbnails"]')};this.mql=window.matchMedia("(min-width: 750px)");if(!this.elements.thumbnails)return;this.elements.viewer.addEventListener("slideChanged",debounce(this.onSlideChanged.bind(this),500));this.elements.thumbnails.querySelectorAll("[data-target]").forEach((e=>{e.querySelector("button").addEventListener("click",this.setActiveMedia.bind(this,e.dataset.target,false))}));if(this.dataset.desktopLayout.includes("thumbnail")&&this.mql.matches)this.removeListSemantic()}onSlideChanged(e){const t=this.elements.thumbnails.querySelector(`[data-target="${e.detail.currentElement.dataset.mediaId}"]`);this.setActiveThumbnail(t)}setActiveMedia(e,t){var i;const s=this.elements.viewer.querySelector(`[data-media-id="${e}"]`)||this.elements.viewer.querySelector("[data-media-id]");if(!s)return;this.elements.viewer.querySelectorAll("[data-media-id]").forEach((e=>{e.classList.remove("is-active")}));(i=s==null?void 0:s.classList)==null?void 0:i.add("is-active");if(t){s.parentElement.firstChild!==s&&s.parentElement.prepend(s);if(this.elements.thumbnails){const t=this.elements.thumbnails.querySelector(`[data-target="${e}"]`);t.parentElement.firstChild!==t&&t.parentElement.prepend(t)}if(this.elements.viewer.slider)this.elements.viewer.resetPages()}this.preventStickyHeader();window.setTimeout((()=>{if(!this.mql.matches||this.elements.thumbnails)s.parentElement.scrollTo({left:s.offsetLeft});const e=s.getBoundingClientRect();if(e.top>-.5)return;const t=e.top+window.scrollY;window.scrollTo({top:t,behavior:"smooth"})}));this.playActiveMedia(s);if(!this.elements.thumbnails)return;const r=this.elements.thumbnails.querySelector(`[data-target="${e}"]`);this.setActiveThumbnail(r);this.announceLiveRegion(s,r.dataset.mediaPosition)}setActiveThumbnail(e){if(!this.elements.thumbnails||!e)return;this.elements.thumbnails.querySelectorAll("button").forEach((e=>e.removeAttribute("aria-current")));e.querySelector("button").setAttribute("aria-current",true);if(this.elements.thumbnails.isSlideVisible(e,10))return;this.elements.thumbnails.slider.scrollTo({left:e.offsetLeft})}announceLiveRegion(e,t){const i=e.querySelector(".product__modal-opener--image img");if(!i)return;i.onload=()=>{this.elements.liveRegion.setAttribute("aria-hidden",false);this.elements.liveRegion.innerHTML=window.accessibilityStrings.imageAvailable.replace("[index]",t);setTimeout((()=>{this.elements.liveRegion.setAttribute("aria-hidden",true)}),2e3)};i.src=i.src}playActiveMedia(e){window.pauseAllMedia();const t=e.querySelector(".deferred-media");if(t)t.loadContent(false)}preventStickyHeader(){this.stickyHeader=this.stickyHeader||document.querySelector("sticky-header");if(!this.stickyHeader)return;this.stickyHeader.dispatchEvent(new Event("preventHeaderReveal"))}removeListSemantic(){if(!this.elements.viewer.slider)return;this.elements.viewer.slider.setAttribute("role","presentation");this.elements.viewer.sliderItems.forEach((e=>e.setAttribute("role","presentation")))}});
